---
title: "Quickstart: Sign in users and call Microsoft Graph in a Universal Windows Platform app"
description: In this quickstart, learn how a Universal Windows Platform (UWP) application can get an access token and call an API protected by Microsoft identity platform.
ROBOTS: NOINDEX
author: Dickson-Mwendia
manager: CelesteDG
ms.author: dmwendia
ms.custom: scenarios:getting-started, "languages:UWP", mode-api
ms.date: 08/18/2022
ms.service: identity-platform

ms.topic: concept-article
#Customer intent: As an application developer, I want to learn how my Universal Windows Platform (XAML) application can get an access token and call an API that's protected by the Microsoft identity platform.
---

# Quickstart: Call the Microsoft Graph API from a Universal Windows Platform (UWP) application

> [!div renderon="docs"]
> Welcome! This probably isn't the page you were expecting. While we work on a fix, this link should take you to the right article:
>
> > [Quickstart: Sign in users and call Microsoft Graph in a Universal Windows Platform app](quickstart-desktop-app-uwp-sign-in.md)
> 
> We apologize for the inconvenience and appreciate your patience while we work to get this resolved.

> [!div renderon="portal" id="display-on-portal" class="sxs-lookup"]
> # Quickstart: Call the Microsoft Graph API from a Universal Windows Platform (UWP) application
>
> In this quickstart, you download and run a code sample that > demonstrates how a Universal Windows Platform (UWP) application can sign in users and get an access token to call the Microsoft Graph API. 
> 
> See [How the sample works](#how-the-sample-works) for an illustration.
> 
> ## Prerequisites
> 
> * An Azure account with an active subscription. [Create an account for free](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).
> * [Visual Studio 2019](https://visualstudio.microsoft.com/vs/)
> 
> #### Step 1: Configure the application
> For the code sample in this quickstart to work, add a **Redirect URI** of `https://login.microsoftonline.com/common/oauth2/nativeclient`.
>
> <button id="makechanges" class="nextstepaction configure-app-button"> Make these changes for me </button
> 
> > [!div id="appconfigured" class="alert alert-info"]
> > ![Already configured](media/quickstart-v2-uwp/green-check.png) Your application is configured with these attributes.
> 
> #### Step 2: Download the Visual Studio project
> 
> Run the project using Visual Studio 2019.
>
> > [!div  class="nextstepaction"]
> > <button id="downloadsample" class="download-sample-button">Download the code sample</button>
> 
> [!INCLUDE [active-directory-develop-path-length-tip](./includes/error-handling-and-tips/path-length-tip.md)]
> 
> 
> #### Step 3: Your app is configured and ready to run
> We have configured your project with values of your app's properties and it's ready to run.
> #### Step 4: Run the application
> 
> To run the sample application on your local machine:
> 
> 1. In the Visual Studio toolbar, choose the right platform (probably **x64** or **x86**, not ARM). The target device should change from *Device* to *Local Machine*.
> 1. Select **Debug** > **Start Without Debugging**.
>     
>     If you're prompted to do so, you might first need to enable **Developer Mode**, and then **Start Without Debugging** again to launch the app.
> 
> When the app's window appears, you can select the **Call Microsoft Graph API** button, enter your credentials, and consent to the permissions requested by the application. If successful, the application displays some token information and data obtained from the call to the Microsoft Graph API.
> 
> ## How the sample works
> 
> ![Shows how the sample app generated by this quickstart works](media/quickstart-v2-uwp/uwp-intro.svg)
> 
> ### MSAL.NET
> 
> MSAL ([Microsoft.Identity.Client](https://www.nuget.org/packages/Microsoft.Identity.Client)) is the library used to sign in users and request security tokens. The security tokens are used to access an API protected by the Microsoft Identity platform. You can install MSAL by running the following command in Visual Studio's *Package Manager Console*:
> 
> ```powershell
> Install-Package Microsoft.Identity.Client
> ```
> 
> ### MSAL initialization
> 
> You can add the reference for MSAL by adding the following code:
> 
> ```csharp
> using Microsoft.Identity.Client;
> ```
> 
> Then, MSAL is initialized using the following code:
> 
> ```csharp
> public static IPublicClientApplication PublicClientApp;
> PublicClientApp = PublicClientApplicationBuilder.Create(ClientId)
>                                                 .WithRedirectUri("https://login.microsoftonline.com/common/oauth2/> nativeclient")
>                                                     .Build();
> ```
> 
> The value of `ClientId` is the **Application (client) ID** of the app you registered in the Azure portal. You can find this value in the app's **Overview** page in the Azure portal.
> 
> ### Requesting tokens
> 
> MSAL has two methods for acquiring tokens in a UWP app: `AcquireTokenInteractive` and `AcquireTokenSilent`.
> 
> #### Get a user token interactively
> 
> Some situations require forcing users to interact with the Microsoft identity platform through a pop-up window to either validate their credentials or to give consent. Some examples include:
> 
> - The first-time users sign in to the application
> - When users may need to reenter their credentials because the password has expired
> - When your application is requesting access to a resource, that the user needs to consent to
> - When two factor authentication is required
> 
> ```csharp
> authResult = await App.PublicClientApp.AcquireTokenInteractive(scopes)
>                       .ExecuteAsync();
> ```
> 
> The `scopes` parameter contains the scopes being requested, such as `{ "user.read" }` for Microsoft Graph or `{ "api://<Application ID>/access_as_user" }` for custom web APIs.
> 
> #### Get a user token silently
> 
> Use the `AcquireTokenSilent` method to obtain tokens to access protected resources after the initial `AcquireTokenInteractive` method. You donâ€™t want to require the user to validate their credentials every time they need to access a resource. Most of the time you want token acquisitions and renewal without any user interaction
> 
> ```csharp
> var accounts = await App.PublicClientApp.GetAccountsAsync();
> var firstAccount = accounts.FirstOrDefault();
> authResult = await App.PublicClientApp.AcquireTokenSilent(scopes, firstAccount)
>                                       .ExecuteAsync();
> ```
> 
> * `scopes` contains the scopes being requested, such as `{ "user.read" }` for Microsoft Graph or `{ "api://<Application ID>/access_as_user" }` for custom web APIs.
> * `firstAccount` specifies the first user account in the cache (MSAL supports multiple users in a single app).
> 
> [!INCLUDE [Help and support](./includes/error-handling-and-tips/help-support-include.md)]
> 
> ## Next steps
> 
> Try out the Windows desktop tutorial for a complete step-by-step guide on building applications and new features, including a full explanation of this quickstart.
> 
> > [!div class="nextstepaction"]
> > [UWP - Call Graph API tutorial](tutorial-v2-windows-uwp.md)
